<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTML Card with Login Modal and Navigation Bar</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm"
        crossorigin="anonymous"></script>
    <!-- Include jQuery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <!-- Include Bootstrap JS -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <!-- Include Link for rating Star Icon -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- Icon -->
    <link rel='stylesheet' href='https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css'>
    <!-- CSS Style -->
    <link rel='stylesheet' href='styles.css'>

</head>

<body style="margin-top: 100px;">
    <div id="navbarContent"></div>

    <header>
        <div class="container">
            <h1 class="text-center">Workspace for Everyone</h1>
        </div>
    </header>

    <main>

        <!-- Cards Landing Page Structre -->
        <div class="container">
            <div class="row row-cols-4 gy-4" id="cardContainer">
            </div>
        </div>


        <!-- Modal for Properties, Modal Structure for Properties -->
        <div id="property-modals">

            <div class="container">
                <!-- <div class="modal fade" id="modal">
                    <div class="modal-dialog modal-dialog-centered modal-xl">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h1>Workspace Name</h1>
                                <button class="btn-close" data-bs-dismiss="modal" data-bs-target="#modal"></button>
                            </div>
                            <div class="modal-body">
                                <img src="/img/coworking.jpg" alt="Image" style="display: flex; margin: 30px 60px;">
                                <p>
                                    Lorem ipsum dolor sit amet consectetur adipisicing elit. Cumque quibusdam,
                                    doloremque, obcaecati debitis voluptatum vel eaque iusto autem blanditiis esse
                                    magnam eveniet totam earum dolores libero eos accusamus eius quidem?
                                    Lorem ipsum dolor sit amet consectetur adipisicing elit. Cumque quibusdam,
                                    doloremque, obcaecati debitis voluptatum vel eaque iusto autem blanditiis esse
                                    magnam eveniet totam earum dolores libero eos accusamus eius quidem?
                                    Lorem ipsum dolor sit amet consectetur adipisicing elit. Cumque quibusdam,
                                    doloremque, obcaecati debitis voluptatum vel eaque iusto autem blanditiis esse
                                    magnam eveniet totam earum dolores libero eos accusamus eius quidem?
                                </p>
                            </div>
                            <div class="modal-footer">
                                <button class="btn btn-primary">Book</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div> -->
        </div>


    </main>

    <footer class="footer bg-dark text-light py-3" style="margin-top: 50px;">

        <div class="container text-center">
            <p>&copy; Co-working Registry. All rights reserved.</p>
        </div>
    </footer>


    <!-- Modal For Login -->
    <div class="container login-container">
        <div class="modal fade" id="logIn">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2 class="login-h2">Account Log-in</h2>
                        <button class="btn-close" data-bs-dismiss="modal" data-bs-target="#logIn"></button>
                    </div>
                    <div class="modal-body">
                        <form novalidate id="loginForm">
                            <div class="form-floating input-container1">
                                <input type="text" id="identifier" name="identifier" required class="form-control input-login1">
                                <label for="identifier" class="form-label input-login1 bi bi-person-fill">&nbsp; Email or Username:</label>
                            </div>
                            <div class="form-floating input-container1">
                                <input type="password" id="password" name="password" required class="form-control input-login1">
                                <label for="password" class="form-label input-login1 bi bi-lock-fill"> &nbsp;Password:</label>
                            </div>
                            
                            <button type="submit" class="btn btn-primary btn-sm float-end buttonLogIn">Login</button>
                            <br><br>
                            <a href="#" id="forgotPassword" class="forgot-passwordLogIn">Forgot Password?</a>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <p>Don't have an account? <a href="#" id="switchToSignUp">Sign up</a></p>
                    </div>

                </div>
            </div>
        </div>
    </div>


    <!-- Modal for forgot password -->
    <div class="container login-container">
        <div class="modal fade" id="modalForgotPassword">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <div>
                        <img src="img/reset_password_icon.png" class="imgLock">
                        </div>
                        <div>
                        <h1 class="modal-title login-h2">Reset Password</h1>
                        </div>
                        <button class="btn-close" data-bs-dismiss="modal" data-bs-target="#logIn"></button>
                    </div>
                    <div class="modal-body">
                        <form novalidate id="forgotPasswordForm">
                            <div class="form-floating login-container">
                                <input type="text" id="forgotPasswordIdentifier" name="forgotPasswordIdentifier"
                                    required class="form-control">
                                <label for="forgotPasswordIdentifier" class="form-label input-login1">Username or Email</label>
                            </div>
                            <br>
                            <div class="form-floating login-container">
                                <input type="password" id="newPassword" name="newPassword" required
                                    class="form-control input-login1">
                                <label for="newPassword input-login1" class="form-label input-login1">New Password</label>
                            </div>
                            <br>
                            <div class="form-floating login-container">
                                <input type="password" id="confirm_new_password" name="confirm_new_password"
                                    class="form-control input-login1" required>
                                <label for="confirm_new_password input-login1" class="form-label input-login1">Confirm New Password</label>
                            </div>
    
                            <button class="btn btn-primary btn-sm float-end buttonLogIn">Submit</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for Sign Up -->
    <div class="container signup-container">
        <div class="modal fade" id="signUp">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content signup-box">
                    <div class="modal-header">
                        <h2 class="modal-title">Sign-up</h2>
                        <button class="btn-close" data-bs-dismiss="modal" data-bs-target="#signUp"></button>
                    </div>
                    <div class="modal-body signup-box">
                        <form novalidate id="signUpForm">
                            <div class="form-floating input-container">
                                <input name="fname" type="text" id="fname" placeholder="John" class="form-control input1"
                                    required>
                                <label for="fname" class="form-label input1  bi bi-person-fill">&nbsp;First Name</label>
                                <div class="invalid-feedback">Invalid Name</div>
                            </div>
                            <br>
                            <div class="form-floating input-container">
                                <input name="lname" type="text" id="lname" placeholder="Doe" class="form-control"
                                    required>
                                <label for="fname" class="form-label input1  bi bi-person-fill">&nbsp;Last Name</label>
                                <div class="invalid-feedback">Invalid Name</div>
                            </div>
                            <br>
                            <div class="form-floating input-container">
                                <input name="username" type="text" id="username" placeholder="John234" class="form-control input1" required>
                                <label for="username" class="form-label input1 bi bi-person-fill">&nbsp; Username</label>
                                <div class="invalid-feedback">Enter a valid Username</div>
                            </div>
                            <br>
                            <div class="form-floating input-container">
                                <input name="email" type="email" id="email" placeholder="example@email.com" class="form-control input1"
                                    required>
                                <label for="email" class="form-label input1 bi bi-envelope-fill"> &nbsp; Email</label>
                                <div class="invalid-feedback">Invalid Email (eg. example@email.com) </div>
                            </div>
                            <br>
                            <div class="form-floating input-container">
                                <input name="phone" type="tel" id="phone" pattern="[0-9]{3}-[0-9]{3}-[0-9]{4}"
                                    placeholder="888-888-8888" class="form-control input1" required>
                                <label for="phone" class="bi bi-phone-fill">&nbsp; Phone Number</label>
                                <div class="invalid-feedback">Invalid Phone Number (eg: 888-888-8888)</div>
                            </div>
                            <br>
                            <select name="role" id="role"  class="form-select select select1">
                                <option value="role" disabled selected>Account Type</option>
                                <option value="owner">Owner</option>
                                <option value="user">User</option>
                            </select>
                            <br>
                            <div class="form-floating input-container">
                                <input type="password" placeholder="Password" id="signUpPassword" class="form-control input1" required>
                                <label for="password" class="form- input1 bi bi-lock-fill"> &nbsp; Password</label>
                            </div>
                            <br>
                            <div class="form-floating input-container">
                                <input type="password" placeholder="Confirm Password" id="confirm_password" class="form-control input1" required>
                                <label for="confirm_password" class="form-label input1 bi bi-lock"> &nbsp; Confirm Password</label>
                            </div>

                           
                            <button class="btn btn-primary btn-sm float-end button1">Sign-Up</button>
                            
                        </form>
                    </div>
                    <div class="modal-footer login-link">
                        <p>Already have an account? <a href="#" id="switchToLogin">Login</a></p>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!-- Verification after signing-up -->
    <div class="container">
        <div class="modal fade" id="signupVerification">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h1 class="modal-title">Email verification</h1>
                        <button class="btn-close" data-bs-dismiss="modal" data-bs-target="#logIn"></button>
                    </div>
                    <div class="modal-body">
                        <p>Please confirm your email to continue using CoWorking Registry</p>
                        <p>Click <a href="https://gmail.com" target="_blank">here</a> to be redirected to your email.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for Contact Us -->
    <div class="container">
        <div class="modal fade" id="contactUs">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h1>Contact Us</h1>
                        <button class="btn-close" data-bs-dismiss="modal" data-bs-target="#contactUs"></button>
                    </div>
                    <div class="modal-body">
                        <div class="contact"> Lorem ipsum dolor sit amet, consectetur adipisicing elit. Iusto esse eos
                            architecto illo ullam quidem at voluptates tempore aspernatur natus magnam vero molestiae
                            nisi rerum nesciunt repellendus, quo quam laboriosam.</div>
                    </div>
                    <div class="modal-footer">

                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- script for navbar include -->
    <script src="/js/navbar.js"></script>
    <!-- script for forgot password -->
    <script src="/js/forgotpassword.js"></script>
    <!-- script for login and signUp -->
    <script src="/js/loginsignup.js"></script>
    <!-- Creates a card for every Workspace -->
    <!-- CREATES MODALS FOR EACH WORKSPACE -->
    <script>

        //SELECTING ALL VALID WORKSPACE THAT HAS A PROPERTY_ID KEY
        const cardContainer = document.getElementById('cardContainer');

        const createCard = (data) => {
            const cardElement = document.createElement('div');
            cardElement.className = 'col';
            cardElement.setAttribute('data-bs-toggle', 'modal');
            cardElement.setAttribute('data-bs-target', `#${data.Workspace.id}modal`);

            const cardContent =
                `<div class="card">
<img src="${data.Workspace.photos == "/img/" || data.Workspace.photos == "" ? `/img/coworking.jpg` : data.Workspace.photos}" alt="Property image" class="card-img-top" id="workspaceImage" style="width:300px; height:200px;">
<div class="card-body">
  <h2 class="card-title">${data.Workspace.name}</h2>
  <span class="card-subtitle">${data.Property.address === undefined ? 'No Address Provided' : `${data.Property.address}`}</span>
  <div class="card-text card-text-star" style="position: absolute; bottom: 20px; right: 20px; padding: 3px 20px 3px 3px">
      <span class="fa fa-star checked" style="color: orange;"></span>
      <p style="position: absolute; top: 2.5px; right: 3px;" class="star-rating">${data.Workspace.ratings}</p>
  </div>
  <div class="card-text">
      ${data.Workspace.description === undefined ? 'No Description Provided' : `${data.Workspace.description}`}
  </div>
  <div class="card-text">
      Price: $ ${data.price} <br>
      Lease Term: ${data.lease_term === null ? 'No Term Chosen' : `${data.lease_term}`}
  </div>
  <div class="card-text" style= "padding-top: 5px">
      <p class="availability">${data.Workspace.availability ? 'Available' : 'Not Available'}</p>
  </div>
</div>`;
            console.log(`The Availability is ${data.Workspace.availability}`);
            cardElement.innerHTML = cardContent;
            cardContainer.appendChild(cardElement);
            updateAvailabilityColor();
        };

        const userId = localStorage.getItem('userID');

        // Fetch data from the API server
        fetch("http://143.198.237.154/api/allworkspace/")
            .then(response => response.json())
            .then(workspacedata => {
                // Loop through the data and create cards
                workspacedata.forEach(workspaceItem => {
                    const path = window.location.pathname;
                    const role = localStorage.getItem('role');
                    if (path == '/workspace' && role == 'owner') {
                        if (userId == workspaceItem.Workspace.user_id) {
                            createCard(workspaceItem);
                        }
                    }
                    else if (path == '/myBookings' && role == 'coworker' || role == 'user') {
                        if (userId == workspaceItem.user_id) {
                            createCard(workspaceItem);
                        }
                    } else {
                        createCard(workspaceItem);
                    }

                });
            })
            .catch(error => console.error('Error fetching data', error));


        const parseBool = (a) => {
            return a ? "Yes" : "No";
        };


        // Function to change availability text color
        function updateAvailabilityColor() {
            // Get all elements with the availability class
            var availabilityElements = document.querySelectorAll('.availability');

            // Loop through each element
            availabilityElements.forEach(function (element) {
                // Check if availability is "Available"
                if (element.textContent.trim() === 'Available') {
                    // Set font color to green
                    element.style.color = 'green';
                } else {
                    // Set font color to red
                    element.style.color = 'red';
                }
            });
        }
    </script>
    </script>

</body>

</html>